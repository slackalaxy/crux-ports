# Description: MPlayer/MPV frontend
# URL: https://www.smplayer.info/en/downloads
# Maintainer: Petar Petrov, slackalaxy at gmail dot com
# Depends on: double-conversion icu mpv qt5

name=smplayer
version=25.6.0
_thmver=20.11.0
_sknver=20.11.0
release=3
source=(https://github.com/smplayer-dev/smplayer/releases/download/v${version}/smplayer-$version.tar.bz2
	https://downloads.sourceforge.net/smplayer/$name-themes-${_thmver}.tar.bz2
	https://downloads.sourceforge.net/smplayer/$name-skins-${_sknver}.tar.bz2)

build() {
	cd $name-$version

	# Disable -Werror (helps building with the newer gcc)
	sed -i "s|-W\ -Wall\ -Werror|-W -Wall|" webserver/Makefile
	
	make \
	QMAKE=qmake-qt5 \
	LRELEASE=lrelease-qt5 \
	PREFIX=/usr \
	QMAKE_OPTS="QMAKE_CXXFLAGS=\"$CFLAGS\""

	make install \
	PREFIX=/usr \
	DESTDIR=$PKG
	
	# include themes
	cd $SRC/$name-themes-${_thmver}
	make
	make PREFIX=/usr DESTDIR=$PKG install
	
	# include skins
	cd $SRC/$name-skins-${_sknver}
	make
	make PREFIX=/usr DESTDIR=$PKG install
	
	# cleanup
	rm -rf $PKG/usr/share/doc
	rm -rf $PKG/usr/share/smplayer/translations
	find $PKG/ -name "README.txt" -delete
}
